define(["keyword/module","lodash"],function(a,b){"use strict";a.registerController("CasesCtrl",["$scope","$state","$stateParams","$templateRequest","$compile","CaseService","CustomKeywordService",function(a,c,d,e,f,g,h){a.projectId=d.id,a.title="TEST CASES",g.list(a.projectId,function(b){a.cases=b}),h.list(a.projectId,function(b){a.customs=b});var i=function(){var c=$("#editCase");c.html(""),e("app/keyword/views/testcase-modal-content.tpl.html").then(function(b){c.html(f(b)(a))}),c.on("hidden.bs.modal",function(){a.current.saved||(a.current.steps=b.cloneDeep(a.current.originSteps),a.current.name=a.current.originName)})};a.addCustomKeyword=function(c,d){var e=$('input[name="customKeywordName"]');if(a.customAdded=!0,a.customMode=!1,void 0===c||null===c||""===c)e.focus(),e.addClass("state-error");else{e.removeClass("state-error");var f={name:c,steps:b.cloneDeep(d.steps)};h.create(a.projectId,f,function(b,c){d.customMode=!1,d.customAdded=!0,a.customs.push(b),$.smallBox({title:"Notification",content:"Your test case has created",color:"#296191",iconSmall:"fa fa-check bounce animated",timeout:3e3})})}},a.toCustomKeywordList=function(){c.go("app.keyword.custom",{id:a.projectId}),a.customAdded=!0,a.customMode=!0},a.newTestCase=function(){a.current={name:"New Test Case",steps:[],temp:!0},i()},a.save=function(){a.current.saved=!0,a.current.temp?g.create(a.projectId,a.current,function(b,c){switch(c){case 201:$.smallBox({title:"Notification",content:"Your test case has created",color:"#296191",iconSmall:"fa fa-check bounce animated",timeout:3e3}),a.cases.push(b);break;default:$.smallBox({title:"Notification",content:"Can not create your test case",color:"#c26565",iconSmall:"fa fa-ban bounce animated",timeout:3e3})}}):g.update(a.projectId,a.current,function(a,b){switch(b){case 200:$.smallBox({title:"Notification",content:"Your test case has updated",color:"#296191",iconSmall:"fa fa-check bounce animated",timeout:3e3});break;case 204:$.smallBox({title:"Notification",content:"Your test case has nothing to update",color:"#296191",iconSmall:"fa fa-check bounce animated",timeout:3e3});break;default:$.smallBox({title:"Notification",content:"Can not update your test case",color:"#c26565",iconSmall:"fa fa-ban bounce animated",timeout:3e3})}}),$("#editCase").modal("hide")},a.removeCase=function(){a.current.temp||g["delete"](a.projectId,a.current._id,function(c,d){switch(d){case 200:$.smallBox({title:"Notification",content:"Your test case has deleted",color:"#296191",iconSmall:"fa fa-check bounce animated",timeout:3e3}),b.remove(a.cases,function(b){return b._id==a.current._id});break;default:$.smallBox({title:"Notification",content:"Can not delete your test case",color:"#c26565",iconSmall:"fa fa-ban bounce animated",timeout:3e3})}})},a.clickToCase=function(c){c.customMode=!1,c.customAdded=!1,c.saved=!1,c.originSteps=b.cloneDeep(c.steps),c.originName=c.name,a.current=c,i()}}])});