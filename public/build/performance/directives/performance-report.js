define(["performance/module"],function(a){"use strict";a.registerDirective("performanceReport",["$state",function(a){return{restrict:"E",replace:!0,scope:{reports:"="},templateUrl:"build/performance/directives/performance-report.tpl.html",link:function(b,c,d){b.openReportEachSampler=function(b,c){a.go("app.performance.report.sampler",{reportId:b._id,index:c})};var e=[],f=[],g=[];_.forEach(b.reports,function(a){a.summary.error_percent=_.round(a.summary.error_percent,2),a.summary.throughtput=_.round(a.summary.throughtput,2),a.summary.kb_per_second=_.round(a.summary.kb_per_second,2),a.summary.average=_.round(a.summary.average,2),a.summary.standard_deviation=_.round(a.summary.standard_deviation,2),a.summary.average_bytes=_.round(a.summary.average_bytes,2)}),b.summaryReport=_.find(b.reports,function(a){return"*SummaryReport*"==a.label}),_.remove(b.reports,function(a){return a.label==b.summaryReport.label});var h=0,i=0,j=[];_.forEach(b.reports,function(a){var b=[];_.forIn(a.hits_per_second,function(a){b.push(a)}),i++,j.push(a.label),e.push(b),b.length>h&&(h=b.length)});for(var k=[],l=[],m=["#00B4A1","#ffaa2a","#ff5050","#ff7832","#9cbe3e","#ffce32","#9855d4","#af6ee8","#3a5ea4","#4178be","#5596e6","#7cc7ff","#7cc7ff","#2dacd1","008571","#a4aeb6","#8996a0","#3a4a58","#9cbe3e","#9855d4","#5aaafa","#3a4a58"],n=0;h>n;n++){var o={};o.y=n;for(var p=0;i>p;p++){var q=j[p];k.length<i&&k.push(q),l.length<i&&l.push(m[p]),null!=e[p][n]&&(o[q]=e[p][n].value)}f.push(o)}var r=$(c).find(".hit-per-second");Morris.Line({element:r,data:f,xkey:"y",ykeys:k,labels:j,lineColors:l,parseTime:!1,lineWidth:1,pointSize:2}),k=[],i=0,h=0,j=[];var s=$(c).find(".tran-per-second");e=[],_.forEach(b.reports,function(a){var b=[];_.forIn(a.trans_per_second,function(a){b.push(a)}),i++,j.push(a.label),e.push(b),b.length>h&&(h=b.length)});for(var n=0;h>n;n++){var o={};o.y=n;for(var p=0;i>p;p++){var q=j[p];k.length<i&&k.push(q),null!=e[p][n]&&(o[q]=e[p][n].value)}g.push(o)}Morris.Line({element:s,data:g,xkey:"y",ykeys:k,labels:j,lineColors:l,parseTime:!1,lineWidth:1,pointSize:2});var t=[],u=_.zipObject(j,l);_.forIn(u,function(a,b){var c={};c.color=a,c.label=b,t.push(c)}),b.colors=t}}}])});