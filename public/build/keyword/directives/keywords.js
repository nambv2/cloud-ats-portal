define(["keyword/module","lodash"],function(a,b){"use strict";a.registerDirective("keywords",["$filter","KeywordService",function(a,c){return{restrict:"E",replace:!0,scope:{"case":"=",customs:"="},templateUrl:"build/keyword/directives/keywords.tpl.html",link:function(d,e,f){d.customKeywordName,d.casecount=0,d.query={},d.keywords={},d.editableOptions={mode:"inline",disabled:!1},d.dropped=function(a,c){var e=($("#"+c),$("#"+a)),f=JSON.parse(e.attr("data-keyword"));f._id&&f.steps?b.forEach(f.steps,function(a){d["case"].steps.push(a)}):f.type&&d["case"].steps.push(f)},d.selectCat=function(a){d.cat=a},d.filterIt=function(){var b=void 0===d.cat?Object.keys(d.query)[0]:d.cat,c=d.query[b],e=d.keywords[b];return void 0!==e&&void 0!==c?a("filter")(e,c):a("filter")(d.keywords,"")},d.buildActionDisplay=function(a){var c=a.type,d=a.params;c+=" (",b.forEach(d,function(a){c+=a,c+=", "});var e=c.lastIndexOf(",");return-1!=e&&(c=c.substring(0,e)),c+=")"},c.getKeywords(function(a){d.keywordList=a;var c=[];b.forEach(a,function(a,b){c.push(b)}),d.cats=c}),d.getKeywordsByCat=function(a){var c=[],e=d.keywordList;return b.forEach(e[a],function(a,d){var d={type:d,description:a.description},e=a.params,f=[];b.forEach(e,function(a,b){if("locator"===b){var c={type:"id",value:""};d.locator=c}else if("targetLocator"===b){var c={type:"id",value:""};d.targetLocator=c}else d[b]="";f.push(b)}),d.params=f,c.push(d)}),d.keywords[a]=c,c},d.buildKeywordFullyQualified=function(a){return a.type.length>10?a.type:d.buildActionDisplay(a)},d.buildParamsDisplay=function(a){var c="";b.forEach(a,function(a){c+=a,c+=", "});var d=c.lastIndexOf(",");return-1!=d&&(c=c.substring(0,d)),c},d.buildParamsPopover=function(a,c){var e=d.keywordList[a][c.type].params,f="<p>"+c.description+"</p>";return b.forEach(e,function(a,b){f+="<p><strong>"+b+"</strong>: "+a+"</p>"}),f}}}}])});