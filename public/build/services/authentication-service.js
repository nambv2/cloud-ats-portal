define(["app"],function(a){"use strict";return a.factory("AuthenticationService",["$http","$q","$log","$cookies","$window","$rootScope","$state","$stateParams","EventService",function(a,b,c,d,e,f,g,h,i){function j(b,c,d){var e={method:"POST",url:appConfig.RestEntry+"/api/v1/user/login",data:{email:b,password:c}};a(e).success(function(a){d(a)}).error(function(a,b,c,e){if(401===b){var a={error:!0,message:"Username or password is incorrect"};d(a)}})}function k(b){var c={method:"GET",url:appConfig.RestEntry+"/api/v1/user/logout",headers:{"X-AUTH-TOKEN":d.get("authToken")}};a(c).success(function(){d.remove("authToken"),(void 0===d.get("space")||"null"==d.get("space"))&&d.remove("space"),e.sessionStorage.removeItem("context"),f.context=null,b()})}function l(b,c,d,e,f,g,h){var i={method:"POST",url:appConfig.RestEntry+"/api/v1/user/register",data:{email:b,password:c,firstname:d,lastname:e,tenant:f,space:g}};a(i).success(function(a){h(a)}).error(function(a,b,c,d){if(401===b){var a={error:!0,message:"register fail"};h(a)}})}function m(b){var c={method:"GET",url:appConfig.RestEntry+"/api/v1/user/tenants"};a(c).success(function(a){b(a)})}function n(){var c=b.defer(),e={method:"GET",url:appConfig.RestEntry+"/api/v1/context",headers:{"X-AUTH-TOKEN":d.get("authToken")}};return a(e).success(function(a){c.resolve(a)}).error(c.reject),c.promise}function o(b,c){var d={method:"GET",url:appConfig.RestEntry+"/api/v1/user/checkAccount?email="+b};a(d).success(function(a){c(a)})}return{login:function(a,b,c){j(a,b,c)},logout:function(a){k(a)},context:function(){return n()},verifyState:function(a){return verifyState(a)},register:function(a,b,c,d,e,f,g){l(a,b,c,d,e,f,g)},getTenants:function(a){m(a)},checkAccount:function(a,b){o(a,b)}}}])});